<ng-include src="'assets/templates/siteNavigation.html'"></ng-include>

<style type="text/css">
    .ui-grid-cell { display: flex; justify-content: center; align-items: center; }
    
    .md-datepicker-input-container { width: 100%; border: solid 1px rgba(0,0,0,.1); margin-bottom: 5px; padding-bottom: 0; }
    md-datepicker { width: 100%; display: flex; flex-direction: row-reverse; }
    .md-icon-button+.md-datepicker-input-container { margin-left: 0; }
    
    .char-title { margin-bottom: 10px; font-weight: bold; }
    
    .row { margin: 0; display: flex; flex-direction: row; }
    .filter { display: flex; flex: 1; flex-direction: column; }
    .body { display: flex; flex: 3; margin-left: 10px; flex-direction: column; height: min-content;  }
    .body .content-row { display: flex; flex: 1; margin-bottom: 40px; }
    .graph-item { display: flex; flex: 1; flex-direction: column; margin-bottom: 4rem; }
    .pie-chart { height: 210px; }
    .polar-chart { height: 280px; }
    
    .ui-grid-grid-footer { display: flex; align-items: center; padding-left: .5rem; border-top: solid .1rem #e0e0e0; background-color: #efefef; }
</style>


<div class="container" ng-init="init()">
 <div ng-show="!isAllowed">
     <h1></h1>
 </div>
<div ng-show="isAllowed">
    <h2>Injury Reports</h2>
    
    <div class="row">
        <div class="filter">
            <div class="date-filter">
                <md-datepicker ng-model="filter.date_from" 
                               md-placeholder="Select date.."
                               md-current-view="year" 
                               md-is-open="isFromOpen"
                               ng-change="updateReport()"
                               md-open-on-focus>
                </md-datepicker>
            </div>
            <div class="date-field">
                <md-datepicker ng-model="filter.date_to"
                               md-placeholder="Select date.."
                               md-current-view="year"
                               md-is-open="isToOpen"
                               ng-change="updateReport()"
                               md-open-on-focus>
                </md-datepicker>
            </div>
            <div ng-show="isDepartmentListExist">
                <div external-scopes="clickHandler" ui-grid="gridOptionsComplexDprt" ng-style="{height: department_length+'px'}"></div> 
            </div>
            <div ng-show="isLocationListExist">
                <div external-scopes="clickHandler" ui-grid="gridOptionsComplexLtn" ng-style="{height: location_length+'px'}"></div> 
            </div>
            <div ng-show="isEmployeeListExist">
                <div external-scopes="clickHandler" ui-grid="gridOptionsComplexEply" ng-style="{height: employees_length+'px'}"></div> 
            </div>
            
            <div ng-show="isPositionListExist">
                <div external-scopes="clickHandler" ui-grid="gridOptionsComplexPosition" ng-style="{height: position_length+'px'}"></div> 
            </div>               
                   
            <div ng-show="isInjuryNatureListExist">
                <div external-scopes="clickHandler" ui-grid="gridOptionsComplexInjNature" ng-style="{height: nature_length+'px'}"></div> 
            </div>         
            <div ng-show="isInjuryMechanismListExist">
                <div external-scopes="clickHandler" ui-grid="gridOptionsComplexInjMech" ng-style="{height: mech_length+'px'}"></div> 
            </div>              
        </div>

        <!-- <div class="col-sm-9 chart-container"> -->

        <div class="body">
            
            
            <div class="content-row">
                <div class="graph-item">
                    <div class="char-title"> 
                        Total Injuries by Department <small style="font-weight: normal; ">({{ selectedDepartment[0].department }})</small>
                    </div>

                    <div class="charts">
                        <canvas class="chart chart-bar"
                            chart-data="departmentBarData" 
                            chart-labels="departmentBarLabels" 
                            chart-series="departmentBarSeries" 
                            chart-options="departmentBarOptions"
                            chart-colors="departmentBarColors">
                        </canvas>
                    </div>         
                </div>

                <div class="graph-item">
                    <div class="char-title"> 
                        Injuries by department
                    </div>
                    <div class="charts" ng-style="{'height': '210px'}">                            
                        <canvas class="chart chart-pie"
                            chart-data="departmentPieData" chart-labels="departmentPieLabels" chart-options="departmentPieOptions">
                        </canvas>
                    </div>        
                </div>

            </div>
            
            <!-- Injuries by location -->
            <div class="content-row">
                <div class="graph-item">
                    <div class="char-title"> 
                        Total Injuries by Location <small style="font-weight: normal; ">({{ selectedLocation[0].location }})</small>
                    </div>

                    <div class="charts">
                        <canvas class="chart chart-bar"
                            chart-data="locationBarData" 
                            chart-labels="locationBarLabels" 
                            chart-series="locationBarSeries" 
                            chart-options="locationBarOptions"
                            chart-colors="locationBarColors">
                        </canvas>
                    </div>         
                </div>

                <div class="graph-item">
                    <div class="char-title"> 
                        Injuries by Location
                    </div>
                    <div class="charts polar-chart">                            
                        <canvas  class="chart chart-polar-area" chart-data="locationPieData" chart-labels="locationPieLabels" chart-options="locationPieOptions"></canvas>
                    </div>        
                </div>

            </div>            
            
            
            <div external-scopes="clickHandler" ui-grid="gridOptionsComplex" style="height: 400px; width: 100%;"></div>
        </div>

    </div>   
</div>
            
            
            
            
            
            
            
            
            
<!--
            <div class="row" ng-hide="true">
                <div class="col-sm-6">
                        <div class="char-title"> 
                            Total Injuries by Department <small style="font-weight: normal; ">({{ selectedDepartment[0].department }})</small>
                        </div>
                    </div>
                    <div class="charts">
                        <canvas class="chart chart-bar"
                            chart-data="departmentBarData" 
                            chart-labels="departmentBarLabels" 
                            chart-series="departmentBarSeries" 
                            chart-options="departmentBarOptions"
                            chart-colors="departmentBarColors">
                        </canvas>
                    </div>                      
                </div>         
            
                <div  class="col-sm-6" ng-hide="false">

                </div>                 

                    
                
                <div class="col-sm-6" ng-hide="true">
                    <div style = "padding:10px 0;">
                        <div class="char-title"> 
                            Total Employees
                        </div>
                    </div>
                    <div class="charts">
                        <canvas id="bar" class="chart chart-bar"
                            chart-data="totalBarData" chart-labels="totalBarLabels" 
                            chart-series="totalBarSeries" chart-colors="totalBarColors" chart-dataset-override="totalBarOverride">
                        </canvas>
                    </div>                      
                </div>
            </div>

            <div class="row">
                <div  class="col-sm-6" ng-hide="true">
                    <div style = "padding:10px 0;">
                        <div class=" char-title">
                            Employee count,{{currentDepartment}}
                        </div>
                    </div>
                    <div class="charts">
                        <canvas id="bar" class="chart chart-bar"
                            chart-data="departmentBarData" chart-labels="departmentBarLabels" chart-series="departmentBarSeries" chart-colors="departmentBarColors">
                        </canvas>
                    </div>
                </div>
                <div  class="col-sm-6" ng-hide="true">
                        <div style = "padding:10px 0;">
                                <div class="char-title"> 
                                        Employee count,{{currentLocation}}
                                </div>
                        </div>
                        <div class="charts">
                                <canvas id="bar" class="chart chart-bar"
                                    chart-data="LocationBarData" chart-labels="LocationBarLabels" chart-series="LocationBarSeries"  chart-colors="locationBarColors">
                                </canvas>
                        </div>
                </div>
            </div>

            <div class="row">
                <div  class="col-sm-6" ng-hide="true">
                        <div style = "padding:10px 0;">
                            <div class="char-title"> 
                                Employees by department,{{currentYear}}
                            </div>
                        </div>
                        <div class="charts" ng-style="{'height': departmentPieHeight}">                            
                            <canvas id="pie" class="chart chart-pie"
                                chart-data="departmentPieData" chart-labels="departmentPieLabels" chart-options="departmentPieOptions">
                            </canvas>
                        </div>
                </div>
                <div class="col-sm-6" ng-hide="true">
                        <div style = "padding:10px 0;">
                            <div class="char-title"> 
                                Employees by location,{{currentYear}}
                            </div>
                        </div>
                        <div class="charts" ng-style="{'height': locationPieHeight}">
                            <canvas id="pie" class="chart chart-pie"
                                chart-data="locationPieData" chart-labels="locationPieLabels" chart-options="locationPieOptions">
                            </canvas> 
                        </div>
                </div>
            </div>

            <div class="row">
                <div  class="col-sm-6" ng-hide="true">
                    <div style = "padding:10px 0;">
                        <div class="char-title"> 
                                Employee information
                        </div>
                    </div>
                    <div class="bottom-charts">
                        <div class="row">
                            <div class="col-sm-12" style="text-align: center;">Name: <span style="font-size: larger;">{{employeeName}}</span></div>                            
                        </div>
                        <div style = "margin-left: 5px; margin-right: 5px;">
                            <div class="row">
                                <div class="col-sm-12" style = "padding:0px;">         
                                    <div class="table-responsive">
                                        <table class="table-bordered"  style = "text-align: center; width: 100%; height: 200px;">
                                            <tr ng-repeat="x in employeePropsLeft">
                                                <td  style = "background-color: lightblue;  width: 40%;">
                                                        {{x}}
                                                </td>
                                                <td>
                                                        {{employee[x]}}
                                                </td>
                                            </tr>
                                            <tr ng-repeat="x in employeePropsRight">
                                                <td  style = "background-color: lightblue;  width: 40%;">
                                                        {{x}}
                                                </td>
                                                <td>
                                                        {{employee[x]}}
                                                </td>
                                            </tr>
                                        </table>     
                                    </div>                  
                                </div>
                            </div> 
                        </div>
                    </div>
                </div>
                <div  class="col-sm-6" ng-hide="true">
                        <div style = "padding:10px 0;">
                            <div class="char-title"> 
                                Employee total compensation
                            </div>
                        </div>
                        <div class="charts">
                                <canvas id="compensationBar" class="chart chart-bar"
                                chart-data="compensationBarData" chart-labels="compensationBarLabels" chart-series="compensationBarSeries" chart-colors="compensationBarColors"
                                >
                                </canvas>
                        </div>
                </div>
            </div>
            

        </div>


        <div class="col-lg-3">

            <div class="row">
                <div class="col-sm-12">
                    <div style = "padding:10px 0;">
                        <div class="char-title">
                            Compensation distribution by department,{{currentYear}}
                        </div>
                        </div>
                    <div class="charts" ng-style="{'height': departmentCompensationHeight}">
                            <canvas id="departmentCompensation" class="chart-horizontal-bar"
                                chart-data="departmentCompensationData" chart-labels="departmentCompensationLabels" 
                                chart-series="departmentCompensationBarSeries" chart-options="departmentCompensationOptions" chart-colors="departmentCompensationColors">
                        </canvas> 
                    </div>
                </div>
            <!-- </div> -->


            <!-- <div class="row"> -- >
                <div class="col-sm-12"  ng-hide="true">
                    <div style = "padding:10px 0;">
                        <div class="char-title">
                            Compensation distribution by location,{{currentYear}}
                        </div>
                    </div>
                    <div class="charts" ng-style="{'height': locationCompensationHeight}">
                            <canvas id="locationCompensation" class="chart-horizontal-bar"
                                chart-data="locationCompensationData" chart-labels="locationCompensationLabels" 
                                chart-series="locationCompensationBarSeries" chart-options="locationCompensationOptions"
                                width="200" height="150">
                            </canvas> 
                    </div>
                </div>
            <!-- </div> -- >

            <!-- <div class="row"> -- > 
                <div class="col-sm-12" ng-hide="true">
                    <div style = "padding:10px 0;">
                        <div class="char-title">
                            Employee count by base salary brackets,{{currentYear}}
                        </div>
                    </div>
                    <div class="charts">
                            <canvas id="base" class="chart-horizontal-bar"
                                chart-data="baseSalaryData" chart-labels="baseSalaryLabels" chart-series="baseSalarySeries" chart-colors="baseSalaryColors"
                                width="200" height="150">
                            </canvas> 
                    </div>
                </div>
            </div>

        </div>
        </div>

    </div>
</div>
</div>